"""
VoxPersonal v4 - –£–º–Ω—ã–π –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç —Å –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–º–∏ –∫–æ–º–∞–Ω–¥–∞–º–∏
–ö–æ–º–∞–Ω–¥—ã: 20+ –ø–æ–ª–µ–∑–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π
"""

import speech_recognition as sr
import pyttsx3
import webbrowser
import subprocess
import os
import time
import pyautogui
import json
import datetime
import random
import requests
import threading
from typing import Optional, Dict, List
import sys

class VoxPersonalV4:
    def __init__(self):
        self.name = "Vox Personal v4"
        self.is_listening = False
        self.user_name = None
        self.volume = 50
        self.weather_api_key = None
        self.command_history = []
        
        # –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã
        self.commands = {
            # –ë–∞–∑–æ–≤—ã–µ
            "–ø—Ä–∏–≤–µ—Ç": self._hello,
            "–∫–∞–∫ –¥–µ–ª–∞": self._how_are_you,
            "–ø–æ–∫–∞": self._goodbye,
            
            # –°–∏—Å—Ç–µ–º–Ω—ã–µ
            "–æ—Ç–∫—Ä–æ–π –±—Ä–∞—É–∑–µ—Ä": self._open_browser,
            "–∑–∞–∫—Ä–æ–π –±—Ä–∞—É–∑–µ—Ä": self._close_browser,
            "–æ—Ç–∫—Ä–æ–π –ø–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è": self._open_control_panel,
            "–∑–∞–ø—É—Å—Ç–∏ –∫–æ–º–∞–Ω–¥–Ω—É—é —Å—Ç—Ä–æ–∫—É": self._open_cmd,
            "–æ—Ç–∫—Ä–æ–π –¥–∏—Å–ø–µ—Ç—á–µ—Ä –∑–∞–¥–∞—á": self._open_task_manager,
            "—Å–¥–µ–ª–∞–π —Å–∫—Ä–∏–Ω—à–æ—Ç": self._take_screenshot,
            
            # –ú–µ–¥–∏–∞
            "–≥—Ä–æ–º—á–µ": self._volume_up,
            "—Ç–∏—à–µ": self._volume_down,
            "—Å—Ç–æ–ø": self._media_stop,
            "–ø–∞—É–∑–∞": self._media_pause_play,
            "–ø—Ä–æ–¥–æ–ª–∂–∏": self._media_pause_play,
            "—Å–ª–µ–¥—É—é—â–∏–π —Ç—Ä–µ–∫": self._next_track,
            "–ø—Ä–µ–¥—ã–¥—É—â–∏–π —Ç—Ä–µ–∫": self._previous_track,
            "–≤–∫–ª—é—á–∏ –º—É–∑—ã–∫—É": self._play_music,
            
            # –ò–Ω—Ç–µ—Ä–Ω–µ—Ç
            "–æ—Ç–∫—Ä–æ–π youtube": self._open_youtube,
            "–æ—Ç–∫—Ä–æ–π –≤–∫": self._open_vk,
            "–ø–æ–∏—Å–∫ –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–µ": self._web_search,
            "–∫–∞–∫–∞—è –ø–æ–≥–æ–¥–∞": self._weather,
            "–∫—É—Ä—Å –≤–∞–ª—é—Ç": self._currency_rate,
            
            # –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–µ
            "—Å–∫–æ–ª—å–∫–æ –≤—Ä–µ–º–µ–Ω–∏": self._what_time,
            "–∫–∞–∫–∞—è –¥–∞—Ç–∞": self._what_date,
            "—Å–ª—É—á–∞–π–Ω–æ–µ —á–∏—Å–ª–æ": self._random_number,
            "—Ä–∞—Å—Å–∫–∞–∂–∏ —à—É—Ç–∫—É": self._tell_joke,
            "–∫—Ç–æ —Ç—ã": self._who_are_you,
            
            # –†–∞–∑–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω—ã–µ
            "–≤–∫–ª—é—á–∏ –∫–∏–Ω–æ": self._play_movie,
            "–ø–æ–∫–∞–∂–∏ –∫–æ—Ç–∏–∫–∞": self._show_cat,
            "—Å–∫–∞–∂–∏ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ": self._fortune_telling,
            
            # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
            "–≤—ã–∫–ª—é—á–∏ –∫–æ–º–ø—å—é—Ç–µ—Ä": self._shutdown_pc,
            "–ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏ –∫–æ–º–ø—å—é—Ç–µ—Ä": self._restart_pc,
            "—Å–≤–µ—Ä–Ω–∏ –≤—Å–µ –æ–∫–Ω–∞": self._minimize_all,
            "—Ä–∞–±–æ—á–∏–π —Å—Ç–æ–ª": self._show_desktop,
            
            # –ü–æ–º–æ—â—å
            "—á—Ç–æ —Ç—ã —É–º–µ–µ—à—å": self._help,
            "–ø–æ–≤—Ç–æ—Ä–∏ –∫–æ–º–∞–Ω–¥—É": self._repeat_command,
        }
        
        # –°–∏–Ω–æ–Ω–∏–º—ã –∫–æ–º–∞–Ω–¥
        self.synonyms = {
            "–∑–¥—Ä–∞–≤—Å—Ç–≤—É–π": "–ø—Ä–∏–≤–µ—Ç",
            "–¥–æ–±—Ä—ã–π –¥–µ–Ω—å": "–ø—Ä–∏–≤–µ—Ç",
            "–¥–æ–±—Ä–æ–µ —É—Ç—Ä–æ": "–ø—Ä–∏–≤–µ—Ç",
            "–¥–æ–±—Ä—ã–π –≤–µ—á–µ—Ä": "–ø—Ä–∏–≤–µ—Ç",
            "—ç–π": "–ø—Ä–∏–≤–µ—Ç",
            "—Å–ª—É—à–∞–π": "–ø—Ä–∏–≤–µ—Ç",
            
            "–∫–∞–∫ –∂–∏–∑–Ω—å": "–∫–∞–∫ –¥–µ–ª–∞",
            "–∫–∞–∫ —Ç—ã": "–∫–∞–∫ –¥–µ–ª–∞",
            "–∫–∞–∫ —Å–∞–º": "–∫–∞–∫ –¥–µ–ª–∞",
            
            "–¥–æ —Å–≤–∏–¥–∞–Ω–∏—è": "–ø–æ–∫–∞",
            "–≤—ã—Ö–æ–¥": "–ø–æ–∫–∞",
            "–∑–∞–≤–µ—Ä—à–∏—Ç—å": "–ø–æ–∫–∞",
            
            "–±—Ä–∞—É–∑–µ—Ä": "–æ—Ç–∫—Ä–æ–π –±—Ä–∞—É–∑–µ—Ä",
            "–≥—É–≥–ª": "–æ—Ç–∫—Ä–æ–π –±—Ä–∞—É–∑–µ—Ä",
            "–∏–Ω—Ç–µ—Ä–Ω–µ—Ç": "–æ—Ç–∫—Ä–æ–π –±—Ä–∞—É–∑–µ—Ä",
            
            "–≤—ã–∫–ª—é—á–∏ –±—Ä–∞—É–∑–µ—Ä": "–∑–∞–∫—Ä–æ–π –±—Ä–∞—É–∑–µ—Ä",
            "–∑–∞–∫—Ä–æ–π –∏–Ω—Ç–µ—Ä–Ω–µ—Ç": "–∑–∞–∫—Ä–æ–π –±—Ä–∞—É–∑–µ—Ä",
            
            "–ø–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è": "–æ—Ç–∫—Ä–æ–π –ø–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è",
            "–Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–∏—Å—Ç–µ–º—ã": "–æ—Ç–∫—Ä–æ–π –ø–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è",
            
            "–∫–æ–º–∞–Ω–¥–Ω–∞—è —Å—Ç—Ä–æ–∫–∞": "–∑–∞–ø—É—Å—Ç–∏ –∫–æ–º–∞–Ω–¥–Ω—É—é —Å—Ç—Ä–æ–∫—É",
            "—Ç–µ—Ä–º–∏–Ω–∞–ª": "–∑–∞–ø—É—Å—Ç–∏ –∫–æ–º–∞–Ω–¥–Ω—É—é —Å—Ç—Ä–æ–∫—É",
            
            "–≤—Ä–µ–º—è": "—Å–∫–æ–ª—å–∫–æ –≤—Ä–µ–º–µ–Ω–∏",
            "–∫–æ—Ç–æ—Ä—ã–π —á–∞—Å": "—Å–∫–æ–ª—å–∫–æ –≤—Ä–µ–º–µ–Ω–∏",
            
            "–¥–∞—Ç–∞": "–∫–∞–∫–∞—è –¥–∞—Ç–∞",
            "—á–∏—Å–ª–æ": "–∫–∞–∫–∞—è –¥–∞—Ç–∞",
            "–¥–µ–Ω—å": "–∫–∞–∫–∞—è –¥–∞—Ç–∞",
            
            "—É–≤–µ–ª–∏—á—å –≥—Ä–æ–º–∫–æ—Å—Ç—å": "–≥—Ä–æ–º—á–µ",
            "—Å–¥–µ–ª–∞–π –≥—Ä–æ–º—á–µ": "–≥—Ä–æ–º—á–µ",
            
            "—É–º–µ–Ω—å—à–∏ –≥—Ä–æ–º–∫–æ—Å—Ç—å": "—Ç–∏—à–µ",
            "—Å–¥–µ–ª–∞–π —Ç–∏—à–µ": "—Ç–∏—à–µ",
            
            "–æ—Å—Ç–∞–Ω–æ–≤–∏": "—Å—Ç–æ–ø",
            "–ø—Ä–µ–∫—Ä–∞—Ç–∏": "—Å—Ç–æ–ø",
            
            "–æ—Å—Ç–∞–Ω–æ–≤–∏ –º—É–∑—ã–∫—É": "—Å—Ç–æ–ø",
            "–ø—Ä–µ–∫—Ä–∞—Ç–∏ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ": "—Å—Ç–æ–ø",
            
            "–ø–æ—Å—Ç–∞–≤—å –Ω–∞ –ø–∞—É–∑—É": "–ø–∞—É–∑–∞",
            "–ø–∞—É–∑–∏": "–ø–∞—É–∑–∞",
            
            "–≤–æ–∑–æ–±–Ω–æ–≤–∏": "–ø—Ä–æ–¥–æ–ª–∂–∏",
            "–¥–∞–ª—å—à–µ": "–ø—Ä–æ–¥–æ–ª–∂–∏",
            
            "—Å–ª–µ–¥—É—é—â–∏–π": "—Å–ª–µ–¥—É—é—â–∏–π —Ç—Ä–µ–∫",
            "—Å–ª–µ–¥—É—é—â–∞—è –ø–µ—Å–Ω—è": "—Å–ª–µ–¥—É—é—â–∏–π —Ç—Ä–µ–∫",
            
            "–ø—Ä–µ–¥—ã–¥—É—â–∏–π": "–ø—Ä–µ–¥—ã–¥—É—â–∏–π —Ç—Ä–µ–∫",
            "–ø—Ä–æ—à–ª—ã–π —Ç—Ä–µ–∫": "–ø—Ä–µ–¥—ã–¥—É—â–∏–π —Ç—Ä–µ–∫",
            
            "–≤–∫–ª—é—á–∏ –≤–∏–¥–µ–æ": "–≤–∫–ª—é—á–∏ –º—É–∑—ã–∫—É",
            "–∑–∞–ø—É—Å—Ç–∏ –º—É–∑—ã–∫—É": "–≤–∫–ª—é—á–∏ –º—É–∑—ã–∫—É",
            
            "—é—Ç—É–±": "–æ—Ç–∫—Ä–æ–π youtube",
            "–≤–∏–¥–µ–æ": "–æ—Ç–∫—Ä–æ–π youtube",
            
            "–≤–∫–æ–Ω—Ç–∞–∫—Ç–µ": "–æ—Ç–∫—Ä–æ–π –≤–∫",
            
            "–Ω–∞–π–¥–∏ –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–µ": "–ø–æ–∏—Å–∫ –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–µ",
            "–∏—â–∏": "–ø–æ–∏—Å–∫ –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–µ",
            "–≥—É–≥–ª–∏": "–ø–æ–∏—Å–∫ –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–µ",
            
            "–ø—Ä–æ–≥–Ω–æ–∑ –ø–æ–≥–æ–¥—ã": "–∫–∞–∫–∞—è –ø–æ–≥–æ–¥–∞",
            "–ø–æ–≥–æ–¥–∞ —Å–µ–π—á–∞—Å": "–∫–∞–∫–∞—è –ø–æ–≥–æ–¥–∞",
            
            "–∫—É—Ä—Å –¥–æ–ª–ª–∞—Ä–∞": "–∫—É—Ä—Å –≤–∞–ª—é—Ç",
            "–∫—É—Ä—Å –µ–≤—Ä–æ": "–∫—É—Ä—Å –≤–∞–ª—é—Ç",
            "–≤–∞–ª—é—Ç—ã": "–∫—É—Ä—Å –≤–∞–ª—é—Ç",
            
            "—Å–ª—É—á–∞–π–Ω–æ–µ": "—Å–ª—É—á–∞–π–Ω–æ–µ —á–∏—Å–ª–æ",
            "—Ä–∞–Ω–¥–æ–º–Ω–æ–µ —á–∏—Å–ª–æ": "—Å–ª—É—á–∞–π–Ω–æ–µ —á–∏—Å–ª–æ",
            
            "–ø–æ—à—É—Ç–∏": "—Ä–∞—Å—Å–∫–∞–∂–∏ —à—É—Ç–∫—É",
            "—Ä–∞—Å—Å–º–µ—à–∏": "—Ä–∞—Å—Å–∫–∞–∂–∏ —à—É—Ç–∫—É",
            
            "–ø—Ä–µ–¥—Å—Ç–∞–≤—å—Å—è": "–∫—Ç–æ —Ç—ã",
            "—Ç–≤–æ—ë –∏–º—è": "–∫—Ç–æ —Ç—ã",
            
            "–≤–∫–ª—é—á–∏ —Ñ–∏–ª—å–º": "–≤–∫–ª—é—á–∏ –∫–∏–Ω–æ",
            "–ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Ñ–∏–ª—å–º": "–≤–∫–ª—é—á–∏ –∫–∏–Ω–æ",
            
            "–ø–æ–∫–∞–∂–∏ –∫–æ—Ç—ë–Ω–∫–∞": "–ø–æ–∫–∞–∂–∏ –∫–æ—Ç–∏–∫–∞",
            "–∫–æ—Ç": "–ø–æ–∫–∞–∂–∏ –∫–æ—Ç–∏–∫–∞",
            
            "–ø—Ä–µ–¥—Å–∫–∞–∂–∏": "—Å–∫–∞–∂–∏ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ",
            "–≥–∞–¥–∞–Ω–∏–µ": "—Å–∫–∞–∂–∏ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ",
            
            "–≤—ã—Ä—É–±–∏ –∫–æ–º–ø—å—é—Ç–µ—Ä": "–≤—ã–∫–ª—é—á–∏ –∫–æ–º–ø—å—é—Ç–µ—Ä",
            "–æ—Ç–∫–ª—é—á–∏ –∫–æ–º–ø—å—é—Ç–µ—Ä": "–≤—ã–∫–ª—é—á–∏ –∫–æ–º–ø—å—é—Ç–µ—Ä",
            
            "–ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞": "–ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏ –∫–æ–º–ø—å—é—Ç–µ—Ä",
            "—Ä–µ–±—É—Ç": "–ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏ –∫–æ–º–ø—å—é—Ç–µ—Ä",
            
            "—Å–≤–µ—Ä–Ω–∏ –æ–∫–Ω–∞": "—Å–≤–µ—Ä–Ω–∏ –≤—Å–µ –æ–∫–Ω–∞",
            "–º–∏–Ω–∏–º–∏–∑–∏—Ä—É–π –≤—Å—ë": "—Å–≤–µ—Ä–Ω–∏ –≤—Å–µ –æ–∫–Ω–∞",
            
            "–Ω–∞ —Ä–∞–±–æ—á–∏–π —Å—Ç–æ–ª": "—Ä–∞–±–æ—á–∏–π —Å—Ç–æ–ª",
            "–¥–µ—Å–∫—Ç–æ–ø": "—Ä–∞–±–æ—á–∏–π —Å—Ç–æ–ª",
            
            "–ø–æ–º–æ—â—å": "—á—Ç–æ —Ç—ã —É–º–µ–µ—à—å",
            "–∫–æ–º–∞–Ω–¥—ã": "—á—Ç–æ —Ç—ã —É–º–µ–µ—à—å",
            "—Ñ—É–Ω–∫—Ü–∏–∏": "—á—Ç–æ —Ç—ã —É–º–µ–µ—à—å",
            
            "–ø–æ–≤—Ç–æ—Ä–∏": "–ø–æ–≤—Ç–æ—Ä–∏ –∫–æ–º–∞–Ω–¥—É",
            "–µ—â—ë —Ä–∞–∑": "–ø–æ–≤—Ç–æ—Ä–∏ –∫–æ–º–∞–Ω–¥—É",
        }
        
        # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        self._init_speech()
        self._load_config()
        
    def _init_speech(self):
        """–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≥–æ–ª–æ—Å–æ–≤—ã—Ö —Å–∏—Å—Ç–µ–º"""
        try:
            # –†–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ
            self.recognizer = sr.Recognizer()
            self.microphone = sr.Microphone()
            
            # –°–∏–Ω—Ç–µ–∑
            self.tts_engine = pyttsx3.init()
            self.tts_engine.setProperty('rate', 180)
            self.tts_engine.setProperty('volume', 1.0)
            
            # –†—É—Å—Å–∫–∏–π –≥–æ–ª–æ—Å
            voices = self.tts_engine.getProperty('voices')
            for voice in voices:
                if 'russian' in voice.name.lower():
                    self.tts_engine.setProperty('voice', voice.id)
                    break
                    
            print(f"‚úÖ {self.name} –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω")
            
        except Exception as e:
            print(f"‚ùå –û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏: {e}")
    
    def _load_config(self):
        """–ó–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏"""
        try:
            if os.path.exists('config.json'):
                with open('config.json', 'r', encoding='utf-8') as f:
                    config = json.load(f)
                    self.user_name = config.get('user_name')
                    self.weather_api_key = config.get('weather_api_key')
                    print("‚úÖ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∑–∞–≥—Ä—É–∂–µ–Ω–∞")
        except:
            pass
    
    def speak(self, text, wait=True):
        """–ü—Ä–æ–∏–∑–Ω–µ—Å—Ç–∏ —Ç–µ–∫—Å—Ç"""
        print(f"[{self.name}]: {text}")
        self.tts_engine.say(text)
        if wait:
            self.tts_engine.runAndWait()
    
    def listen(self, timeout=5, phrase_time_limit=7):
        """–°–ª—É—à–∞—Ç—å –º–∏–∫—Ä–æ—Ñ–æ–Ω"""
        try:
            with self.microphone as source:
                self.recognizer.adjust_for_ambient_noise(source, duration=1)
                print("üé§ –°–ª—É—à–∞—é...")
                
                audio = self.recognizer.listen(
                    source, 
                    timeout=timeout,
                    phrase_time_limit=phrase_time_limit
                )
                
                print("üîç –†–∞—Å–ø–æ–∑–Ω–∞—é...")
                text = self.recognizer.recognize_google(audio, language="ru-RU").lower()
                
                if text:
                    print(f"[–í—ã]: {text}")
                    return text
                
        except sr.WaitTimeoutError:
            return None
        except sr.UnknownValueError:
            return None
        except Exception as e:
            print(f"‚ùå –û—à–∏–±–∫–∞ —Å–ª—É—à–∞–Ω–∏—è: {e}")
            return None
    
    # ===== –ù–û–í–´–ï –ö–û–ú–ê–ù–î–´ =====
    
    def _hello(self):
        """–ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ —Å –∏–º–µ–Ω–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"""
        greetings = [
            "–ü—Ä–∏–≤–µ—Ç—Å—Ç–≤—É—é!",
            "–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ!",
            "–ü—Ä–∏–≤–µ—Ç! –†–∞–¥ –≤–∞—Å —Å–ª—ã—à–∞—Ç—å.",
            "–î–æ–±—Ä—ã–π –¥–µ–Ω—å!",
            "–ü—Ä–∏–≤–µ—Ç, –¥—Ä—É–≥!"
        ]
        
        if self.user_name:
            return f"{random.choice(greetings)} –ö–∞–∫ –≤–∞—à–∏ –¥–µ–ª–∞, {self.user_name}?"
        else:
            return f"{random.choice(greetings)} –ú–µ–Ω—è –∑–æ–≤—É—Ç {self.name}. –ö–∞–∫ –≤–∞—Å –∑–æ–≤—É—Ç?"
    
    def _how_are_you(self):
        """–°–æ—Å—Ç–æ—è–Ω–∏–µ –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞"""
        moods = [
            "–í—Å—ë –æ—Ç–ª–∏—á–Ω–æ! –ì–æ—Ç–æ–≤ –ø–æ–º–æ–≥–∞—Ç—å.",
            "–ü—Ä–µ–∫—Ä–∞—Å–Ω–æ, –∫–∞–∫ –Ω–∏–∫–æ–≥–¥–∞!",
            "–í–µ–ª–∏–∫–æ–ª–µ–ø–Ω–æ, —Å–ø–∞—Å–∏–±–æ —á—Ç–æ —Å–ø—Ä–æ—Å–∏–ª–∏!",
            "–†–∞–±–æ—Ç–∞—é –≤ –ø–æ–ª–Ω—É—é —Å–∏–ª—É!",
            "–ì–æ—Ç–æ–≤ –∫ –Ω–æ–≤—ã–º –∑–∞–¥–∞—á–∞–º!"
        ]
        return random.choice(moods)
    
    def _open_browser(self):
        """–û—Ç–∫—Ä—ã—Ç—å –±—Ä–∞—É–∑–µ—Ä —Å –≤—ã–±–æ—Ä–æ–º"""
        browsers = {
            "chrome": r"C:\Program Files\Google\Chrome\Application\chrome.exe",
            "firefox": r"C:\Program Files\Mozilla Firefox\firefox.exe",
            "edge": r"C:\Program Files (x86)\Microsoft\Edge\Application\msedge.exe",
            "opera": r"C:\Users\%USERNAME%\AppData\Local\Programs\Opera\opera.exe"
        }
        
        for name, path in browsers.items():
            try:
                if os.path.exists(os.path.expandvars(path)):
                    subprocess.Popen([path])
                    return f"–ó–∞–ø—É—Å–∫–∞—é {name}"
            except:
                continue
        
        # –ï—Å–ª–∏ –Ω–µ –Ω–∞—à–µ–ª –±—Ä–∞—É–∑–µ—Ä—ã, –æ—Ç–∫—Ä—ã–≤–∞–µ–º —á–µ—Ä–µ–∑ webbrowser
        webbrowser.open("https://google.com")
        return "–û—Ç–∫—Ä—ã–≤–∞—é Google –≤ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–º –±—Ä–∞—É–∑–µ—Ä–µ"
    
    def _close_browser(self):
        """–ó–∞–∫—Ä—ã—Ç—å –≤—Å–µ –±—Ä–∞—É–∑–µ—Ä—ã (—É–º–Ω—ã–π —Å–ø–æ—Å–æ–±)"""
        try:
            if os.name == 'nt':  # Windows
                subprocess.run('taskkill /f /im chrome.exe /t', shell=True, capture_output=True)
                subprocess.run('taskkill /f /im firefox.exe /t', shell=True, capture_output=True)
                subprocess.run('taskkill /f /im msedge.exe /t', shell=True, capture_output=True)
                subprocess.run('taskkill /f /im opera.exe /t', shell=True, capture_output=True)
                return "–í—Å–µ –±—Ä–∞—É–∑–µ—Ä—ã –∑–∞–∫—Ä—ã—Ç—ã"
            else:
                return "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥–∏—Å–ø–µ—Ç—á–µ—Ä –∑–∞–¥–∞—á –¥–ª—è –∑–∞–∫—Ä—ã—Ç–∏—è –±—Ä–∞—É–∑–µ—Ä–æ–≤"
        except:
            return "–ó–∞–∫—Ä–æ–π—Ç–µ –±—Ä–∞—É–∑–µ—Ä—ã –≤—Ä—É—á–Ω—É—é —á–µ—Ä–µ–∑ –¥–∏—Å–ø–µ—Ç—á–µ—Ä –∑–∞–¥–∞—á"
    
    def _open_control_panel(self):
        """–û—Ç–∫—Ä—ã—Ç—å –ø–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è"""
        try:
            subprocess.run('control', shell=True)
            return "–û—Ç–∫—Ä—ã–≤–∞—é –ø–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è Windows"
        except:
            return "–ù–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–∫—Ä—ã—Ç—å –ø–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è"
    
    def _open_cmd(self):
        """–û—Ç–∫—Ä—ã—Ç—å –∫–æ–º–∞–Ω–¥–Ω—É—é —Å—Ç—Ä–æ–∫—É"""
        try:
            subprocess.Popen('cmd', shell=True)
            return "–ó–∞–ø—É—Å–∫–∞—é –∫–æ–º–∞–Ω–¥–Ω—É—é —Å—Ç—Ä–æ–∫—É"
        except:
            return "–ù–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–∫—Ä—ã—Ç—å –∫–æ–º–∞–Ω–¥–Ω—É—é —Å—Ç—Ä–æ–∫—É"
    
    def _open_task_manager(self):
        """–û—Ç–∫—Ä—ã—Ç—å –¥–∏—Å–ø–µ—Ç—á–µ—Ä –∑–∞–¥–∞—á"""
        try:
            subprocess.Popen('taskmgr', shell=True)
            return "–û—Ç–∫—Ä—ã–≤–∞—é –¥–∏—Å–ø–µ—Ç—á–µ—Ä –∑–∞–¥–∞—á"
        except:
            return "–ù–∞–∂–º–∏—Ç–µ Ctrl+Shift+Esc –¥–ª—è –¥–∏—Å–ø–µ—Ç—á–µ—Ä–∞ –∑–∞–¥–∞—á"
    
    def _take_screenshot(self):
        """–°–¥–µ–ª–∞—Ç—å —Å–∫—Ä–∏–Ω—à–æ—Ç"""
        try:
            screenshot = pyautogui.screenshot()
            filename = f"screenshot_{datetime.datetime.now().strftime('%Y%m%d_%H%M%S')}.png"
            screenshot.save(filename)
            return f"–°–∫—Ä–∏–Ω—à–æ—Ç —Å–æ—Ö—Ä–∞–Ω—ë–Ω –∫–∞–∫ {filename}"
        except Exception as e:
            return f"–ù–µ —É–¥–∞–ª–æ—Å—å —Å–¥–µ–ª–∞—Ç—å —Å–∫—Ä–∏–Ω—à–æ—Ç: {str(e)}"
    
    def _volume_up(self):
        """–£–≤–µ–ª–∏—á–∏—Ç—å –≥—Ä–æ–º–∫–æ—Å—Ç—å"""
        try:
            for _ in range(5):
                pyautogui.press('volumeup')
            self.volume = min(100, self.volume + 20)
            return f"–ì—Ä–æ–º–∫–æ—Å—Ç—å: {self.volume}%"
        except:
            return "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–Ω–æ–ø–∫–∏ –≥—Ä–æ–º–∫–æ—Å—Ç–∏ –Ω–∞ –∫–ª–∞–≤–∏–∞—Ç—É—Ä–µ"
    
    def _volume_down(self):
        """–£–º–µ–Ω—å—à–∏—Ç—å –≥—Ä–æ–º–∫–æ—Å—Ç—å"""
        try:
            for _ in range(5):
                pyautogui.press('volumedown')
            self.volume = max(0, self.volume - 20)
            return f"–ì—Ä–æ–º–∫–æ—Å—Ç—å: {self.volume}%"
        except:
            return "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–Ω–æ–ø–∫–∏ –≥—Ä–æ–º–∫–æ—Å—Ç–∏ –Ω–∞ –∫–ª–∞–≤–∏–∞—Ç—É—Ä–µ"
    
    def _media_stop(self):
        """–û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –º–µ–¥–∏–∞"""
        try:
            pyautogui.press('stop')
            return "–í–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ"
        except:
            return "–ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É —Å—Ç–æ–ø –≤ –≤–∞—à–µ–º –ø–ª–µ–µ—Ä–µ"
    
    def _media_pause_play(self):
        """–ü–∞—É–∑–∞/–ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å"""
        try:
            pyautogui.press('playpause')
            return "–ü–µ—Ä–µ–∫–ª—é—á–∏–ª –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ"
        except:
            return "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–Ω–æ–ø–∫—É –ø–∞—É–∑—ã –≤ –≤–∞—à–µ–º –ø–ª–µ–µ—Ä–µ"
    
    def _next_track(self):
        """–°–ª–µ–¥—É—é—â–∏–π —Ç—Ä–µ–∫"""
        try:
            pyautogui.hotkey('ctrl', 'right')
            return "–ü–µ—Ä–µ–∫–ª—é—á–∞—é –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–π —Ç—Ä–µ–∫"
        except:
            return "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Ctrl+‚Üí –¥–ª—è —Å–ª–µ–¥—É—é—â–µ–≥–æ —Ç—Ä–µ–∫–∞"
    
    def _previous_track(self):
        """–ü—Ä–µ–¥—ã–¥—É—â–∏–π —Ç—Ä–µ–∫"""
        try:
            pyautogui.hotkey('ctrl', 'left')
            return "–ü–µ—Ä–µ–∫–ª—é—á–∞—é –Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â–∏–π —Ç—Ä–µ–∫"
        except:
            return "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Ctrl+‚Üê –¥–ª—è –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —Ç—Ä–µ–∫–∞"
    
    def _play_music(self):
        """–í–∫–ª—é—á–∏—Ç—å –º—É–∑—ã–∫—É"""
        try:
            webbrowser.open("https://music.youtube.com")
            return "–í–∫–ª—é—á–∞—é YouTube Music"
        except:
            return "–û—Ç–∫—Ä–æ–π—Ç–µ –≤–∞—à –º—É–∑—ã–∫–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–∏—Å"
    
    def _open_youtube(self):
        """–û—Ç–∫—Ä—ã—Ç—å YouTube"""
        webbrowser.open("https://youtube.com")
        return "–û—Ç–∫—Ä—ã–≤–∞—é YouTube"
    
    def _open_vk(self):
        """–û—Ç–∫—Ä—ã—Ç—å –í–ö–æ–Ω—Ç–∞–∫—Ç–µ"""
        webbrowser.open("https://vk.com")
        return "–û—Ç–∫—Ä—ã–≤–∞—é –í–ö–æ–Ω—Ç–∞–∫—Ç–µ"
    
    def _web_search(self):
        """–ü–æ–∏—Å–∫ –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–µ"""
        self.speak("–ß—Ç–æ –∏—Å–∫–∞—Ç—å –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–µ?", wait=False)
        query = self.listen()
        if query:
            webbrowser.open(f"https://www.google.com/search?q={query}")
            return f"–ò—â—É '{query}' –≤ Google"
        return "–°–∫–∞–∂–∏—Ç–µ —á—Ç–æ –∏—Å–∫–∞—Ç—å"
    
    def _weather(self):
        """–ü–æ–≥–æ–¥–∞ (–∑–∞–≥–ª—É—à–∫–∞ - –º–æ–∂–Ω–æ –ø–æ–¥–∫–ª—é—á–∏—Ç—å API)"""
        cities = ["–ú–æ—Å–∫–≤–µ", "–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥–µ", "–ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫–µ", "–ï–∫–∞—Ç–µ—Ä–∏–Ω–±—É—Ä–≥–µ"]
        temps = random.randint(-10, 30)
        conditions = ["—Å–æ–ª–Ω–µ—á–Ω–æ", "–æ–±–ª–∞—á–Ω–æ", "–¥–æ–∂–¥–ª–∏–≤–æ", "—Å–Ω–µ–∂–Ω–æ", "–ø–∞—Å–º—É—Ä–Ω–æ"]
        
        city = random.choice(cities)
        condition = random.choice(conditions)
        
        return f"–í {city} —Å–µ–π—á–∞—Å {temps}¬∞C, {condition}. –î–ª—è —Ç–æ—á–Ω–æ–≥–æ –ø—Ä–æ–≥–Ω–æ–∑–∞ —Å–∫–∞–∂–∏—Ç–µ '—É—Å—Ç–∞–Ω–æ–≤–∏ –∫–ª—é—á –ø–æ–≥–æ–¥—ã'"
    
    def _currency_rate(self):
        """–ö—É—Ä—Å –≤–∞–ª—é—Ç (–∑–∞–≥–ª—É—à–∫–∞)"""
        usd = round(random.uniform(70, 90), 2)
        eur = round(random.uniform(75, 95), 2)
        return f"–ö—É—Ä—Å –¥–æ–ª–ª–∞—Ä–∞: {usd} —Ä—É–±., –µ–≤—Ä–æ: {eur} —Ä—É–±. –î–∞–Ω–Ω—ã–µ –ø—Ä–∏–±–ª–∏–∑–∏—Ç–µ–ª—å–Ω—ã–µ"
    
    def _what_time(self):
        """–¢–µ–∫—É—â–µ–µ –≤—Ä–µ–º—è"""
        now = datetime.datetime.now()
        return f"–°–µ–π—á–∞—Å {now.strftime('%H:%M')}"
    
    def _what_date(self):
        """–¢–µ–∫—É—â–∞—è –¥–∞—Ç–∞"""
        now = datetime.datetime.now()
        months = [
            "—è–Ω–≤–∞—Ä—è", "—Ñ–µ–≤—Ä–∞–ª—è", "–º–∞—Ä—Ç–∞", "–∞–ø—Ä–µ–ª—è", "–º–∞—è", "–∏—é–Ω—è",
            "–∏—é–ª—è", "–∞–≤–≥—É—Å—Ç–∞", "—Å–µ–Ω—Ç—è–±—Ä—è", "–æ–∫—Ç—è–±—Ä—è", "–Ω–æ—è–±—Ä—è", "–¥–µ–∫–∞–±—Ä—è"
        ]
        return f"–°–µ–≥–æ–¥–Ω—è {now.day} {months[now.month-1]} {now.year} –≥–æ–¥–∞"
    
    def _random_number(self):
        """–°–ª—É—á–∞–π–Ω–æ–µ —á–∏—Å–ª–æ"""
        num = random.randint(1, 100)
        return f"–í–∞—à–µ —Å–ª—É—á–∞–π–Ω–æ–µ —á–∏—Å–ª–æ: {num}"
    
    def _tell_joke(self):
        """–†–∞—Å—Å–∫–∞–∑–∞—Ç—å —à—É—Ç–∫—É"""
        jokes = [
            "–ü–æ—á–µ–º—É –ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç –≤—Å–µ–≥–¥–∞ –º–æ–∫—Ä—ã–π? –ü–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω –ø–æ—Å—Ç–æ—è–Ω–Ω–æ –≤ –±–∞—Å—Å–µ–π–Ω–µ –∫–æ–¥–∞!",
            "–ß—Ç–æ —Å–∫–∞–∑–∞–ª –æ–¥–∏–Ω –º–∞—Å—Å–∏–≤ –¥—Ä—É–≥–æ–º—É? –ü—Ä–∏–≤–µ—Ç, —è —Ç–≤–æ–π –æ—Ç–µ—Ü!",
            "–ü–æ—á–µ–º—É Python –Ω–µ –º–æ–∂–µ—Ç –ø–æ–ª—é–±–∏—Ç—å? –ü–æ—Ç–æ–º—É —á—Ç–æ —É –Ω–µ–≥–æ –Ω–µ—Ç —Å–µ—Ä–¥—Ü–∞, —Ç–æ–ª—å–∫–æ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ç–æ—Ä!",
            "–ö–∞–∫–æ–π —è–∑—ã–∫ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏—è —Å–∞–º—ã–π —Ä–æ–º–∞–Ω—Ç–∏—á–Ω—ã–π? –õ—é–±–≤–∏-–°–∫—Ä–∏–ø—Ç!",
            "–ó–∞—á–µ–º –ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç—É –∑–µ—Ä–∫–∞–ª–æ? –ß—Ç–æ–±—ã –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –Ω–∞ —Å–≤–æ–π –æ—Ç—Ä–∞–∂–µ–Ω–Ω—ã–π –∫–æ–¥!",
            "–ß—Ç–æ –≥–æ–≤–æ—Ä–∏—Ç null, –∫–æ–≥–¥–∞ –≤—Å—Ç—Ä–µ—á–∞–µ—Ç undefined? –¢—ã –º–Ω–µ –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω!",
            "–ü–æ—á–µ–º—É –∫–æ–º–ø—å—é—Ç–µ—Ä –ø–æ—à—ë–ª –∫ –≤—Ä–∞—á—É? –£ –Ω–µ–≥–æ –±—ã–ª –≤–∏—Ä—É—Å!",
        ]
        return random.choice(jokes)
    
    def _who_are_you(self):
        """–ü—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞"""
        return f"–Ø {self.name}, –≤–∞—à –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –≥–æ–ª–æ—Å–æ–≤–æ–π –ø–æ–º–æ—â–Ω–∏–∫. –Ø —É–º–µ—é —É–ø—Ä–∞–≤–ª—è—Ç—å –∫–æ–º–ø—å—é—Ç–µ—Ä–æ–º, –∏—Å–∫–∞—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–µ, —Ä–∞—Å—Å–∫–∞–∑—ã–≤–∞—Ç—å —à—É—Ç–∫–∏ –∏ –º–Ω–æ–≥–æ–µ –¥—Ä—É–≥–æ–µ!"
    
    def _play_movie(self):
        """–í–∫–ª—é—á–∏—Ç—å –∫–∏–Ω–æ"""
        platforms = ["https://www.netflix.com", "https://www.kinopoisk.ru", "https://www.ivi.ru"]
        webbrowser.open(random.choice(platforms))
        return "–û—Ç–∫—Ä—ã–≤–∞—é –ø–ª–∞—Ç—Ñ–æ—Ä–º—É –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Ñ–∏–ª—å–º–æ–≤"
    
    def _show_cat(self):
        """–ü–æ–∫–∞–∑–∞—Ç—å –∫–æ—Ç–∏–∫–∞"""
        webbrowser.open("https://thecatapi.com/api/images/get?format=src&type=gif")
        return "–°–º–æ—Ç—Ä–∏—Ç–µ –Ω–∞ —ç—Ç–æ–≥–æ –º–∏–ª–æ–≥–æ –∫–æ—Ç–∏–∫–∞!"
    
    def _fortune_telling(self):
        """–ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ"""
        fortunes = [
            "–°–µ–≥–æ–¥–Ω—è –≤–∞—Å –∂–¥—ë—Ç —É–¥–∞—á–∞ –≤ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–∏!",
            "–í—Å–∫–æ—Ä–µ –≤—ã –Ω–∞–π–¥—ë—Ç–µ –±–∞–≥, –∫–æ—Ç–æ—Ä—ã–π –∏—Å–∫–∞–ª–∏ –º–µ—Å—è—Ü.",
            "–°–µ–≥–æ–¥–Ω—è –æ—Ç–ª–∏—á–Ω—ã–π –¥–µ–Ω—å –¥–ª—è –∏–∑—É—á–µ–Ω–∏—è –Ω–æ–≤–æ–≥–æ —Ñ—Ä–µ–π–º–≤–æ—Ä–∫–∞!",
            "–í–∞—Å –∂–¥—ë—Ç –∏–Ω—Ç–µ—Ä–µ—Å–Ω–∞—è –∑–∞–¥–∞—á–∞ –Ω–∞ —Ä–∞–±–æ—Ç–µ.",
            "–ù–µ –±–æ–π—Ç–µ—Å—å –ø—Ä–æ–±–æ–≤–∞—Ç—å –Ω–æ–≤—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ —Å–µ–≥–æ–¥–Ω—è!",
            "–í–∞—à –∫–æ–¥ —Å–µ–≥–æ–¥–Ω—è –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Å –ø–µ—Ä–≤–æ–≥–æ —Ä–∞–∑–∞!",
        ]
        return random.choice(fortunes)
    
    def _shutdown_pc(self):
        """–í—ã–∫–ª—é—á–∏—Ç—å –∫–æ–º–ø—å—é—Ç–µ—Ä"""
        self.speak("–í—ã —É–≤–µ—Ä–µ–Ω—ã —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –≤—ã–∫–ª—é—á–∏—Ç—å –∫–æ–º–ø—å—é—Ç–µ—Ä? –°–∫–∞–∂–∏—Ç–µ –¥–∞ –∏–ª–∏ –Ω–µ—Ç")
        confirm = self.listen()
        if confirm and "–¥–∞" in confirm:
            if os.name == 'nt':
                os.system("shutdown /s /t 30")
                return "–ö–æ–º–ø—å—é—Ç–µ—Ä –≤—ã–∫–ª—é—á–∏—Ç—Å—è —á–µ—Ä–µ–∑ 30 —Å–µ–∫—É–Ω–¥. –î–ª—è –æ—Ç–º–µ–Ω—ã —Å–∫–∞–∂–∏—Ç–µ '–æ—Ç–º–µ–Ω–∞ –≤—ã–∫–ª—é—á–µ–Ω–∏—è'"
            else:
                return "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–º–∞–Ω–¥—É 'sudo shutdown now' –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ"
        return "–í—ã–∫–ª—é—á–µ–Ω–∏–µ –æ—Ç–º–µ–Ω–µ–Ω–æ"
    
    def _restart_pc(self):
        """–ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å –∫–æ–º–ø—å—é—Ç–µ—Ä"""
        if os.name == 'nt':
            os.system("shutdown /r /t 30")
            return "–ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —á–µ—Ä–µ–∑ 30 —Å–µ–∫—É–Ω–¥"
        return "–ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ –∫–æ–º–ø—å—é—Ç–µ—Ä —á–µ—Ä–µ–∑ –º–µ–Ω—é –ü—É—Å–∫"
    
    def _minimize_all(self):
        """–°–≤–µ—Ä–Ω—É—Ç—å –≤—Å–µ –æ–∫–Ω–∞"""
        pyautogui.hotkey('win', 'd')
        return "–í—Å–µ –æ–∫–Ω–∞ —Å–≤–µ—Ä–Ω—É—Ç—ã"
    
    def _show_desktop(self):
        """–ü–æ–∫–∞–∑–∞—Ç—å —Ä–∞–±–æ—á–∏–π —Å—Ç–æ–ª"""
        pyautogui.hotkey('win', 'd')
        return "–ü–æ–∫–∞–∑—ã–≤–∞—é —Ä–∞–±–æ—á–∏–π —Å—Ç–æ–ª"
    
    def _help(self):
        """–ü–æ–∫–∞–∑–∞—Ç—å —Å–ø–∏—Å–æ–∫ –∫–æ–º–∞–Ω–¥"""
        categories = {
            "üéØ –ë–∞–∑–æ–≤—ã–µ": ["–ø—Ä–∏–≤–µ—Ç", "–∫–∞–∫ –¥–µ–ª–∞", "–ø–æ–∫–∞"],
            "üíª –°–∏—Å—Ç–µ–º–∞": ["–æ—Ç–∫—Ä–æ–π –±—Ä–∞—É–∑–µ—Ä", "–∑–∞–∫—Ä–æ–π –±—Ä–∞—É–∑–µ—Ä", "–æ—Ç–∫—Ä–æ–π –ø–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è", "—Å–¥–µ–ª–∞–π —Å–∫—Ä–∏–Ω—à–æ—Ç"],
            "üéµ –ú–µ–¥–∏–∞": ["–≥—Ä–æ–º—á–µ", "—Ç–∏—à–µ", "—Å—Ç–æ–ø", "–ø–∞—É–∑–∞", "—Å–ª–µ–¥—É—é—â–∏–π —Ç—Ä–µ–∫", "–≤–∫–ª—é—á–∏ –º—É–∑—ã–∫—É"],
            "üåê –ò–Ω—Ç–µ—Ä–Ω–µ—Ç": ["–æ—Ç–∫—Ä–æ–π youtube", "–ø–æ–∏—Å–∫ –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–µ", "–∫–∞–∫–∞—è –ø–æ–≥–æ–¥–∞", "–∫—É—Ä—Å –≤–∞–ª—é—Ç"],
            "üìÖ –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è": ["—Å–∫–æ–ª—å–∫–æ –≤—Ä–µ–º–µ–Ω–∏", "–∫–∞–∫–∞—è –¥–∞—Ç–∞", "—Å–ª—É—á–∞–π–Ω–æ–µ —á–∏—Å–ª–æ", "—Ä–∞—Å—Å–∫–∞–∂–∏ —à—É—Ç–∫—É"],
            "üéÆ –†–∞–∑–≤–ª–µ—á–µ–Ω–∏—è": ["–≤–∫–ª—é—á–∏ –∫–∏–Ω–æ", "–ø–æ–∫–∞–∂–∏ –∫–æ—Ç–∏–∫–∞", "—Å–∫–∞–∂–∏ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ"],
            "‚öôÔ∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ": ["–≤—ã–∫–ª—é—á–∏ –∫–æ–º–ø—å—é—Ç–µ—Ä", "—Å–≤–µ—Ä–Ω–∏ –≤—Å–µ –æ–∫–Ω–∞", "—Ä–∞–±–æ—á–∏–π —Å—Ç–æ–ª"]
        }
        
        response = "–Ø —É–º–µ—é –º–Ω–æ–≥–æ–µ! –í–æ—Ç –æ—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:\n\n"
        for category, commands in categories.items():
            response += f"{category}:\n"
            for cmd in commands:
                response += f"  ‚Ä¢ {cmd}\n"
            response += "\n"
        
        response += "–ü—Ä–æ—Å—Ç–æ —Å–∫–∞–∂–∏—Ç–µ '–ø—Ä–∏–≤–µ—Ç' –¥–ª—è –Ω–∞—á–∞–ª–∞ –æ–±—â–µ–Ω–∏—è!"
        return response
    
    def _repeat_command(self):
        """–ü–æ–≤—Ç–æ—Ä–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω—é—é –∫–æ–º–∞–Ω–¥—É"""
        if self.command_history:
            last_cmd = self.command_history[-1]
            return f"–ü–æ–≤—Ç–æ—Ä—è—é –ø–æ—Å–ª–µ–¥–Ω—é—é –∫–æ–º–∞–Ω–¥—É: '{last_cmd}'"
        return "–ò—Å—Ç–æ—Ä–∏—è –∫–æ–º–∞–Ω–¥ –ø—É—Å—Ç–∞"
    
    def _goodbye(self):
        """–ü—Ä–æ—â–∞–Ω–∏–µ"""
        farewells = [
            "–î–æ —Å–≤–∏–¥–∞–Ω–∏—è! –ë—É–¥—É —Ä–∞–¥ –ø–æ–º–æ—á—å —Å–Ω–æ–≤–∞.",
            "–ü–æ–∫–∞! –û–±—Ä–∞—â–∞–π—Ç–µ—Å—å –µ—Å–ª–∏ —á—Ç–æ.",
            "–í—Å–µ–≥–æ —Ö–æ—Ä–æ—à–µ–≥–æ!",
            "–î–æ –≤—Å—Ç—Ä–µ—á–∏!",
            "–ü–æ–∫–∞, –Ω–µ —Å–∫—É—á–∞–π—Ç–µ!"
        ]
        self.is_listening = False
        return random.choice(farewells)
    
    def process_command(self, text):
        """–û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–º–∞–Ω–¥—ã"""
        if not text:
            return None
        
        # –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ –∏—Å—Ç–æ—Ä–∏—é
        self.command_history.append(text[:50])  # –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –¥–ª–∏–Ω—É
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ç–æ—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ
        for cmd, func in self.commands.items():
            if cmd in text:
                return func()
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–∏–Ω–æ–Ω–∏–º—ã
        for synonym, command in self.synonyms.items():
            if synonym in text and command in self.commands:
                return self.commands[command]()
        
        # –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏–º–µ–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        if "–º–µ–Ω—è –∑–æ–≤—É—Ç" in text:
            name = text.split("–º–µ–Ω—è –∑–æ–≤—É—Ç")[-1].strip()
            self.user_name = name
            return f"–ü—Ä–∏—è—Ç–Ω–æ –ø–æ–∑–Ω–∞–∫–æ–º–∏—Ç—å—Å—è, {name}!"
        
        # –ï—Å–ª–∏ –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–ª–∏
        responses = [
            "–ò–∑–≤–∏–Ω–∏—Ç–µ, –Ω–µ –ø–æ–Ω—è–ª –∫–æ–º–∞–Ω–¥—É. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–∫–∞–∑–∞—Ç—å '—á—Ç–æ —Ç—ã —É–º–µ–µ—à—å'",
            "–ù–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–ª –∫–æ–º–∞–Ω–¥—É. –°–∫–∞–∂–∏—Ç–µ '–ø–æ–º–æ—â—å' –¥–ª—è —Å–ø–∏—Å–∫–∞ –∫–æ–º–∞–Ω–¥",
            "–ü–æ–≤—Ç–æ—Ä–∏—Ç–µ, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, —è –Ω–µ –ø–æ–Ω—è–ª",
            "–ú–æ–∂–µ—Ç–µ –ø–æ–≤—Ç–æ—Ä–∏—Ç—å –∫–æ–º–∞–Ω–¥—É?"
        ]
        return random.choice(responses)
    
    def run(self):
        """–û—Å–Ω–æ–≤–Ω–æ–π —Ü–∏–∫–ª —Ä–∞–±–æ—Ç—ã"""
        self.speak(f"{self.name} –∑–∞–ø—É—â–µ–Ω. –°–∫–∞–∂–∏—Ç–µ '–ø—Ä–∏–≤–µ—Ç' –¥–ª—è –Ω–∞—á–∞–ª–∞ –æ–±—â–µ–Ω–∏—è!")
        
        while True:
            try:
                # –ñ–¥–µ–º –∞–∫—Ç–∏–≤–∞—Ü–∏–∏
                print("\nüîç –ñ–¥—É –∞–∫—Ç–∏–≤–∞—Ü–∏–∏...")
                text = self.listen()
                
                if text and any(word in text for word in ["–ø—Ä–∏–≤–µ—Ç", "—ç–π", "–æ–∫–µ–π", "—Å–ª—É—à–∞–π", "–∫–æ–º–ø—å—é—Ç–µ—Ä"]):
                    response = self.process_command(text)
                    if response:
                        self.speak(response)
                    
                    # –†–µ–∂–∏–º –∞–∫—Ç–∏–≤–Ω–æ–≥–æ —Å–ª—É—à–∞–Ω–∏—è
                    while True:
                        print("\nüìù –û–∂–∏–¥–∞—é –∫–æ–º–∞–Ω–¥—É...")
                        command = self.listen()
                        
                        if command:
                            if "–ø–æ–∫–∞" in command or "–≤—ã—Ö–æ–¥" in command:
                                response = self.process_command(command)
                                self.speak(response)
                                return
                            
                            response = self.process_command(command)
                            if response:
                                self.speak(response)
                        
                        time.sleep(0.5)
                        
                elif text:
                    # –ü–æ–ø—Ä–æ–±—É–µ–º –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –±–µ–∑ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏
                    response = self.process_command(text)
                    if response:
                        self.speak(response)
                        
            except KeyboardInterrupt:
                self.speak("–†–∞–±–æ—Ç–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞")
                break
            except Exception as e:
                print(f"‚ùå –û—à–∏–±–∫–∞: {e}")
                time.sleep(1)

if __name__ == "__main__":
    print("=" * 60)
    print("ü§ñ VoxPersonal v4 - –£–º–Ω—ã–π –≥–æ–ª–æ—Å–æ–≤–æ–π –ø–æ–º–æ—â–Ω–∏–∫")
    print("=" * 60)
    print("\nüìã –î–æ—Å—Ç—É–ø–Ω–æ –±–æ–ª–µ–µ 30 –∫–æ–º–∞–Ω–¥!")
    print("üí° –°–∫–∞–∂–∏—Ç–µ '—á—Ç–æ —Ç—ã —É–º–µ–µ—à—å' –¥–ª—è —Å–ø–∏—Å–∫–∞ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π")
    print("üé§ –ê–∫—Ç–∏–≤–∏—Ä—É–π—Ç–µ –ø–æ–º–æ—â–Ω–∏–∫–∞ —Å–ª–æ–≤–æ–º '–ø—Ä–∏–≤–µ—Ç' –∏–ª–∏ '—ç–π'\n")
    print("=" * 60)
    
    assistant = VoxPersonalV4()
    assistant.run()